import json
import requests
from bs4 import BeautifulSoup
import os



script_dir = os.path.dirname(os.path.abspath(__file__))
file_path = os.path.join(script_dir, "data.txt")






#get the number of subpages in this category
def page_number(soup):
    pagination = soup.find('ul', {'class':'page-list clearfix'})
    if pagination:
        page_links = pagination.find_all('a')
        return int(page_links[-2].text)
    else: return 1



#get the products of subpages
def get_product(url,page):
    page_url = f"{url}?page={page}"
    page_response = requests.get(page_url)
    page_soup = BeautifulSoup(page_response.content, 'lxml')
    return page_soup.find_all("div", {"class":"thumbnail-container text-xs-center"})





def main_tunisianet():
    data_list=[]
    dic={'Pc Portable': 'https://www.tunisianet.com.tn/301-pc-portable-tunisie', 'Pc Portable Gamer': 'https://www.tunisianet.com.tn/681-pc-portable-gamer', 'Pc Portable Pro': 'https://www.tunisianet.com.tn/703-pc-portable-pro', 'Casque & Écouteurs': 'https://www.tunisianet.com.tn/338-casque-ecouteurs', 'Sacoche & Sac à dos': 'https://www.tunisianet.com.tn/331-sac-a-dos-tunisie', 'Souris': 'https://www.tunisianet.com.tn/334-souris-informatique', 'Claviers': 'https://www.tunisianet.com.tn/704-claviers', 'Ensemble Clavier et Souris': 'https://www.tunisianet.com.tn/332-ensemble-clavier-et-souris', 'Tapis de souris': 'https://www.tunisianet.com.tn/488-tapis-souris-tunisie', 'Refroidisseur': 'https://www.tunisianet.com.tn/500-refroidisseur', 'Lecteur de cartes & Hub USB': 'https://www.tunisianet.com.tn/498-hub-usb-lecteur-carte-tunisie', 'Accessoires Ecran': 'https://www.tunisianet.com.tn/658-accessoires-ecran', 'Accessoires Gaming': 'https://www.tunisianet.com.tn/683-accessoires-gaming', 'Webcam': 'https://www.tunisianet.com.tn/336-webcam', 'Ecran': 'https://www.tunisianet.com.tn/667-ecran-pc-tunisie', 'Pc de bureau': 'https://www.tunisianet.com.tn/373-pc-de-bureau', 'Pc de Bureau Gamer': 'https://www.tunisianet.com.tn/682-pc-de-bureau-gamer', 'Pc Tout en un': 'https://www.tunisianet.com.tn/686-pc-tout-en-un', 'Sécurité': 'https://www.tunisianet.com.tn/386-logiciel-antivirus-tunisie', 'Microsoft': 'https://www.tunisianet.com.tn/388-logiciel-microsoft-tunisie', 'Disque dur Interne': 'https://www.tunisianet.com.tn/408-disque-dur-interne', 'Afficheur': 'https://www.tunisianet.com.tn/413-afficheur-pc-portable-prix-tunisie', 'Ventilateur & Refroidisseur': 'https://www.tunisianet.com.tn/427-refroidisseur-ventilateur-boitier', 'Processeur': 'https://www.tunisianet.com.tn/421-processeur', 'Barrette mémoire': 'https://www.tunisianet.com.tn/409-barrette-memoire', 'Carte mère': 'https://www.tunisianet.com.tn/420-carte-mere', 'Carte graphique': 'https://www.tunisianet.com.tn/410-carte-graphique-tunisie', 'Clavier pour pc portable': 'https://www.tunisianet.com.tn/489-clavier-pour-pc-portable', 'Batterie pour Pc portable': 'https://www.tunisianet.com.tn/412-batterie-pour-pc-portable', 'Chargeur pour Pc portable': 'https://www.tunisianet.com.tn/411-chargeur-pour-pc-portable', "Boîte d'alimentation": 'https://www.tunisianet.com.tn/423-boite-alimentation-pc-tunisie', 'Boîtier': 'https://www.tunisianet.com.tn/425-boitier', 'Lecteur & Graveur': 'https://www.tunisianet.com.tn/422-lecteur-graveur', 'Divers': 'https://www.tunisianet.com.tn/429-divers', 'Tablette': 'https://www.tunisianet.com.tn/515-tablette', 'Tablette Graphique': 'https://www.tunisianet.com.tn/728-tablette-graphique', 'Etui de protection pour tablette': 'https://www.tunisianet.com.tn/511-etui-de-protection-pour-tablette', 'Chargeur et Câble pour tablette': 'https://www.tunisianet.com.tn/510-chargeur-et-cable-pour-tablette', 'Film de protection pour tablette': 'https://www.tunisianet.com.tn/512-film-de-protection-pour-tablette', 'Divers pour tablette': 'https://www.tunisianet.com.tn/514-divers-pour-tablette', 'Etui de protection pour Téléphones': 'https://www.tunisianet.com.tn/517-etui-de-protection-pour-telephones', 'Film de protection pour Smartphones': 'https://www.tunisianet.com.tn/518-film-de-protection-pour-smartphones', 'Chargeurs et Câbles pour Téléphones': 'https://www.tunisianet.com.tn/516-chargeurs-et-cables-pour-telephones', 'Power Bank': 'https://www.tunisianet.com.tn/636-power-bank-tunisie', 'Divers pour Téléphones': 'https://www.tunisianet.com.tn/519-divers-pour-telephones', 'Disques Internes Standards': 'https://www.tunisianet.com.tn/458-disques-internes-standards', 'Disque SSD': 'https://www.tunisianet.com.tn/379-disques-ssd', 'Disques Internes pour Serveur de Stockage': 'https://www.tunisianet.com.tn/670-disques-internes-pour-serveur-de-stockage', 'Disques Internes pour Vidéosurveillance': 'https://www.tunisianet.com.tn/671-disques-internes-pour-videosurveillance', 'Imprimante à réservoir intégré': 'https://www.tunisianet.com.tn/455-imprimante-a-reservoir-integre', "Imprimante et Multifonction Jet d'encre": 'https://www.tunisianet.com.tn/321-imprimante-et-multifonction-jet-d-encre', 'Imprimante et Multifonction Laser': 'https://www.tunisianet.com.tn/318-imprimante-et-multifonction-laser', 'Imprimante professionnelle': 'https://www.tunisianet.com.tn/436-imprimante-professionnelle', 'Accessoires Imprimantes': 'https://www.tunisianet.com.tn/698-accessoires-imprimantes', 'Photocopieurs A4 | A3': 'https://www.tunisianet.com.tn/446-photocopieurs-a4-a3', 'Accessoires photocopieurs': 'https://www.tunisianet.com.tn/447-accessoires-photocopieurs', 'Papier A4': 'https://www.tunisianet.com.tn/464-rames-papier-a4', 'Papier A3': 'https://www.tunisianet.com.tn/474-rames-papier-a3', 'Enveloppe': 'https://www.tunisianet.com.tn/483-enveloppe-tunisie-fourniture', 'Papier Photo': 'https://www.tunisianet.com.tn/486-papier-photo', 'Originales': 'https://www.tunisianet.com.tn/730-originales', 'Adaptables': 'https://www.tunisianet.com.tn/731-adaptables', 'Vidéoprojecteurs': 'https://www.tunisianet.com.tn/666-videoprojecteurs', 'Accessoires pour Vidéoprojecteurs': 'https://www.tunisianet.com.tn/496-accessoires-pour-videoprojecteurs', 'Consoles': 'https://www.tunisianet.com.tn/467-consoles', 'Manettes de Jeux': 'https://www.tunisianet.com.tn/341-manettes-de-jeux', 'Accessoires pour Cônsoles': 'https://www.tunisianet.com.tn/468-accessoires-pour-consoles', 'Téléviseurs': 'https://www.tunisianet.com.tn/665-televiseurs', 'Accessoires pour téléviseurs': 'https://www.tunisianet.com.tn/539-accessoires-pour-televiseurs', 'Récepteur': 'https://www.tunisianet.com.tn/668-recepteur', 'Accessoires pour Récepteurs': 'https://www.tunisianet.com.tn/629-accessoires-pour-recepteurs', 'Abonnement Récepteur': 'https://www.tunisianet.com.tn/672-abonnement-recepteur', 'Appareils Photos': 'https://www.tunisianet.com.tn/371-appareils-photos-numerique', 'Accessoires pour Appareils Photos': 'https://www.tunisianet.com.tn/372-accessoires-pour-appareils-photos', 'Piles': 'https://www.tunisianet.com.tn/570-piles', 'Chargeurs': 'https://www.tunisianet.com.tn/571-chargeurs', 'Torches': 'https://www.tunisianet.com.tn/569-torche-tunisie', 'Ensemble Home Cinéma': 'https://www.tunisianet.com.tn/685-ensemble-home-cinema-tunise', 'Barre de son': 'https://www.tunisianet.com.tn/690-barre-de-son', 'Haut-Parleur': 'https://www.tunisianet.com.tn/687-haut-parleur', 'Radio - Réveil': 'https://www.tunisianet.com.tn/688-radio-reveil-tunisie', 'Chaîne Stéréo': 'https://www.tunisianet.com.tn/689-chaine-stereo', 'Microphone': 'https://www.tunisianet.com.tn/485-microphone', 'Réfrigérateurs': 'https://www.tunisianet.com.tn/525-refrigerateur-tunisie', 'Congélateurs': 'https://www.tunisianet.com.tn/526-congelateur-tunisie', 'Hottes': 'https://www.tunisianet.com.tn/527-hotte-aspirante-tunisie', 'Encastrable / Cuisinière': 'https://www.tunisianet.com.tn/540-plaque-de-cuisson', 'Fontaine Fraîche': 'https://www.tunisianet.com.tn/706-fontaine-eau-tunisie', 'Machine à laver / Sèche Linge': 'https://www.tunisianet.com.tn/528-lave-linge-tunisie', 'Lave vaisselle': 'https://www.tunisianet.com.tn/541-lave-vaisselle-tunisie', 'Grille-pain': 'https://www.tunisianet.com.tn/536-grille-pain-toast-tunisie', 'Appareil de cuisson / Convivial': 'https://www.tunisianet.com.tn/538-appareil-de-cuisson-convivial', 'Mini four électrique / Micro-onde': 'https://www.tunisianet.com.tn/564-four-electrique-tunisie-micro-onde', 'Balance de cuisine': 'https://www.tunisianet.com.tn/568-balance-de-cuisine-tunisie', 'Mixeurs / Blenders': 'https://www.tunisianet.com.tn/529-mixeur-plongeant-tunisie', 'Hachoirs': 'https://www.tunisianet.com.tn/530-hachoir-tunisie-a-viande', 'Batteurs': 'https://www.tunisianet.com.tn/531-batteur-electrique-tunisie', 'Centrifugeuses': 'https://www.tunisianet.com.tn/532-centrifugeuse-prix-tunisie', 'Presse Agrumes / Légumes': 'https://www.tunisianet.com.tn/533-presse-agrumes-tunisie', 'Robots multifonction': 'https://www.tunisianet.com.tn/534-robot-multifonction-tunisie', 'Cafetières et moulin à café': 'https://www.tunisianet.com.tn/537-cafetiere-tunisie', 'Aspirateur - Nettoyeur Vapeur': 'https://www.tunisianet.com.tn/558-aspirateur-tunisie-vapeur', 'Repassage & Accessoires': 'https://www.tunisianet.com.tn/559-repassage-accessoires', 'Beauté Masculine': 'https://www.tunisianet.com.tn/560-beaute-masculine', 'Beauté Féminine': 'https://www.tunisianet.com.tn/561-seche-cheveux-tunisie', 'Santé connectée - Bien être - Massage': 'https://www.tunisianet.com.tn/562-sante-connectee-bien-etre-massage', 'Alarme Filaire': 'https://www.tunisianet.com.tn/710-alarme-filaire', 'Alarme sans fil': 'https://www.tunisianet.com.tn/711-alarme-sans-fil', 'Accessoires': 'https://www.tunisianet.com.tn/725-accessoires', 'Caméra de surveillance': 'https://www.tunisianet.com.tn/630-camera-de-surveillance', 'Kit sécurité': 'https://www.tunisianet.com.tn/633-kit-securite', 'Enregistreur': 'https://www.tunisianet.com.tn/634-enregistreur-dvr-nvr', 'Accessoires sécurité': 'https://www.tunisianet.com.tn/635-accessoires-securite', 'Détecteurs et Capteurs': 'https://www.tunisianet.com.tn/631-detecteurs-et-capteurs', 'Tiroirs Caisses et Coffres-forts': 'https://www.tunisianet.com.tn/576-tiroirs-caisses-et-coffres-forts', 'Caisses Enregistreuses': 'https://www.tunisianet.com.tn/577-caisse-enregistreuse-tunisie', 'Douchettes': 'https://www.tunisianet.com.tn/578-douchettes', 'Destructeurs de papiers': 'https://www.tunisianet.com.tn/579-destructeurs-de-papiers', 'Perforelieuses': 'https://www.tunisianet.com.tn/580-perforelieuses', 'Imprimante point de vente': 'https://www.tunisianet.com.tn/581-imprimante-point-de-vente', 'Plastifieuses': 'https://www.tunisianet.com.tn/641-plastifieuses', 'Compteuse de billets': 'https://www.tunisianet.com.tn/661-compteuse-de-billets', 'Stylos à bille': 'https://www.tunisianet.com.tn/476-fourniture-stylos-feutres-rollers-tunisie', 'Stylos premium': 'https://www.tunisianet.com.tn/584-stylos-premium', 'Stylos confort': 'https://www.tunisianet.com.tn/583-stylos-confort', 'Stylos Pointe Fine': 'https://www.tunisianet.com.tn/586-stylos-pointe-fine', 'Stylos feutre': 'https://www.tunisianet.com.tn/582-stylos-feutre', 'Crayons & Porte-mines': 'https://www.tunisianet.com.tn/478-fourniture-crayons-porte-mines-tunisie', 'Surligneurs': 'https://www.tunisianet.com.tn/477-fourniture-surligneurs-tunisie', 'Marqueurs': 'https://www.tunisianet.com.tn/479-fourniture-marqueurs-tunisie', 'Correction': 'https://www.tunisianet.com.tn/480-fourniture-correction-tunisie', 'Recharge Stylos et feutres': 'https://www.tunisianet.com.tn/549-recharge-stylos-et-feutres', 'Règles': 'https://www.tunisianet.com.tn/640-regles', 'Porte-stylos': 'https://www.tunisianet.com.tn/653-porte-stylos', 'Loupes': 'https://www.tunisianet.com.tn/654-loupes', 'Cachets & Tampons': 'https://www.tunisianet.com.tn/655-cachets-tampons', 'Accessories': 'https://www.tunisianet.com.tn/656-accessoire-bureautique', 'Cadenas': 'https://www.tunisianet.com.tn/628-cadenas', 'Boîtes de classement': 'https://www.tunisianet.com.tn/502-boites-de-classement', 'Chemises & Sous-chemises': 'https://www.tunisianet.com.tn/503-chemises-sous-chemises', 'Classeurs': 'https://www.tunisianet.com.tn/504-classeurs', 'Portes documents': 'https://www.tunisianet.com.tn/505-portes-documents', 'Corbeilles à courrier': 'https://www.tunisianet.com.tn/506-corbeilles-a-courrier', 'Corbeilles': 'https://www.tunisianet.com.tn/585-corbeilles', 'Trieur': 'https://www.tunisianet.com.tn/652-trieur', 'Cahiers & Bloc-notes': 'https://www.tunisianet.com.tn/602-cahiers-bloc-notes', 'Post-it - Pense bête': 'https://www.tunisianet.com.tn/590-post-it-pense-bete', 'Etiquettes': 'https://www.tunisianet.com.tn/624-etiquettes', 'Découpe': 'https://www.tunisianet.com.tn/482-fourniture-decoupe-tunisie', 'Agrafage': 'https://www.tunisianet.com.tn/551-agrafage', 'Perforateur': 'https://www.tunisianet.com.tn/552-perforateur', 'Colles': 'https://www.tunisianet.com.tn/555-colles', 'Rouleau scotch': 'https://www.tunisianet.com.tn/588-rouleau-scotch', 'Reliure & Spiral': 'https://www.tunisianet.com.tn/620-reliure-spiral', 'Trombones & Pinces': 'https://www.tunisianet.com.tn/625-trombones-pinces', 'Punaises & Épingles': 'https://www.tunisianet.com.tn/626-punaises-epingles', 'Elastiques': 'https://www.tunisianet.com.tn/627-elastiques', 'Tableaux en Liège': 'https://www.tunisianet.com.tn/573-tableaux-en-liege', 'Tableaux Blancs': 'https://www.tunisianet.com.tn/574-tableaux-blancs', 'Tableaux Vitrine': 'https://www.tunisianet.com.tn/575-tableaux-vitrine', 'Tableaux à Craie': 'https://www.tunisianet.com.tn/691-tableaux-a-craie', 'Accessoires tableaux': 'https://www.tunisianet.com.tn/657-accessoires-tableaux', "Switch / Routeurs / Point d'accès": 'https://www.tunisianet.com.tn/441-switch-routeurs-point-d-acces', 'Carte Réseau': 'https://www.tunisianet.com.tn/442-carte-reseau', 'Clé Wifi - Bluetooth': 'https://www.tunisianet.com.tn/443-cle-wifi-bluetooth', 'CPL': 'https://www.tunisianet.com.tn/453-cpl', 'Coffrets et Armoires Réseau': 'https://www.tunisianet.com.tn/673-coffrets-et-armoires-reseau', 'Multiprise': 'https://www.tunisianet.com.tn/674-multiprise', 'Accessoires Réseau': 'https://www.tunisianet.com.tn/726-accessoires-reseau', 'Abonnements Internet': 'https://www.tunisianet.com.tn/587-abonnements-internet', 'Câbles HDMI': 'https://www.tunisianet.com.tn/350-cable-hdmi-prix-tunisie', 'Câbles USB': 'https://www.tunisianet.com.tn/351-cable-usb-prix-tunisie', 'Câbles Réseau': 'https://www.tunisianet.com.tn/352-cable-rj45-prix-tunisie', 'Câbles Firewire': 'https://www.tunisianet.com.tn/353-cables-firewire', 'Câbles Ecrans TV / AUDIO / DVD': 'https://www.tunisianet.com.tn/354-cables-ecrans-tv-audio-dvd', 'Câbles Alimentation': 'https://www.tunisianet.com.tn/355-cables-alimentation', 'Adaptateurs / Convertisseurs': 'https://www.tunisianet.com.tn/356-adaptateurs-convertisseurs', 'Serveur informatique': 'https://www.tunisianet.com.tn/375-serveur-informatique-tunisie', 'Onduleur': 'https://www.tunisianet.com.tn/380-onduleur', 'Téléphone Portable': 'https://www.tunisianet.com.tn/377-telephone-portable-tunisie', 'Smartphone': 'https://www.tunisianet.com.tn/596-smartphone-tunisie', 'Téléphone Fixe': 'https://www.tunisianet.com.tn/462-telephone-fixe', 'SmartWatch': 'https://www.tunisianet.com.tn/650-smartwatch', 'Disque Dur externe': 'https://www.tunisianet.com.tn/313-disque-dur-externe-tunisie', 'Serveur de stockage': 'https://www.tunisianet.com.tn/389-serveur-stockage-tunisie', 'Accessoires pour Stockage': 'https://www.tunisianet.com.tn/469-accessoires-pour-stockage', 'Clé USB': 'https://www.tunisianet.com.tn/314-cle-usb-tunisie', 'Carte mémoire': 'https://www.tunisianet.com.tn/315-carte-memoire-tunisie', 'CD et DVD Vierge': 'https://www.tunisianet.com.tn/452-cd-dvd-vierge', 'Fax': 'https://www.tunisianet.com.tn/324-appareil-fax-telephone-tunisie', 'Scanners': 'https://www.tunisianet.com.tn/326-scanner-informatique', 'Montres': 'https://www.tunisianet.com.tn/550-montre-homme-femme-tunisie', 'Machine à coudre': 'https://www.tunisianet.com.tn/699-machine-a-coudre', 'Chauffage': 'https://www.tunisianet.com.tn/553-chauffage-tunisie', 'Climatisation': 'https://www.tunisianet.com.tn/457-climatiseur-tunisie-chaud-froid', 'Ventilateurs': 'https://www.tunisianet.com.tn/713-ventilateur-tunisie', 'Scooter Electriques': 'https://www.tunisianet.com.tn/705-scooter-electriques', 'Calculatrices': 'https://www.tunisianet.com.tn/449-calculatrice-tunisie', 'Nettoyage': 'https://www.tunisianet.com.tn/499-nettoyage', 'Décoration': 'https://www.tunisianet.com.tn/676-decoration', 'Bagageries': 'https://www.tunisianet.com.tn/623-bagageries'}
   
   
    for key, value in dic.items():
                response = requests.get(value)
                soup = BeautifulSoup(response.content, "lxml")
                for page in range(1, page_number(soup)+1):
                    for laptop in get_product(value,page):
                        name = laptop.find("h2",{"class":"h3 product-title"}).text.strip()
                        link = laptop.find("a")['href']
                        price = laptop.find("span", class_="price").text.strip()
                        image_link = laptop.find("img", {"class":"center-block img-responsive"})['src']
                        ref=soup.find('span', {"class":"product-reference"}).text.strip()
                        description = laptop.find("p").text.strip()
                        data = {"categorie": key,"link": link,"name": name,"price": price,"image": image_link,"ref": ref,"description": description}
                        if data not in data_list:
                            data_list.append(data)
    with open('data.json', 'w') as f:
        json.dump(data_list, f)